<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Музыкальная страница</title>
	 <script>
    function base64ToHex(base64Str) {
      // Decoding Base64 to bytes
      const bytes = atob(base64Str);
      
      // Converting bytes to hexadecimal string
      let hexStr = '';
      for (let i = 0; i < bytes.length; i++) {
        const hex = bytes.charCodeAt(i).toString(16);
        hexStr += hex.length === 1 ? '0' + hex : hex;
      }
      
      return hexStr;
    }

    function convertBase64ToHex() {
      const base64Input = document.getElementById('base64Input').value;
      const hexOutput = document.getElementById('hexOutput');
      
      if (base64Input === '') {
        hexOutput.value = 'Please enter a Base64 string.';
        return;
      }
      
      const hexStr = base64ToHex(base64Input);
      hexOutput.value = hexStr;
    }
  </script>
</head>

<body>
    <button onclick="startMusic()">Start Music</button>
    <button onclick="stopMusic()">Stop Music</button>
    <br><br>
    <label for="tempoSlider">Adjust Tempo:</label>
    <input type="range" min="50" max="200" value="100" class="tempo-slider" id="tempoSlider">
    <span id="currentTempo">100 BPM</span>
    <br><br>
    <label for="musicInput">Enter Music Notes:</label>
    <input type="text" id="musicInput" placeholder="e.g., 123abc">
   
    
    <br><br>
	  <h1>Base64 to Hex Encoder</h1>
  <label for="base64Input">Enter Base64 string:</label>
  <input type="text" id="base64Input" placeholder="Enter Base64 string" />
  <button onclick="convertBase64ToHex()">Convert</button>
  <br />
  <label for="hexOutput">Hexadecimal output:</label>
  <textarea id="hexOutput" rows="4" cols="50" readonly></textarea>
	
	
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.0.0"></script>
    <script>
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        let buffer, source;
        let tempo = 100;
        let isPlaying = false;

        function loadNoteBuffer(note, duration) {
            const frequencies = {
                '0': 261.63,
                '1': 277.18,
                '2': 293.66,
                '3': 311.13,
                '4': 329.63,
                '5': 349.23,
                '6': 369.99,
                '7': 392.00,
                '8': 415.30,
                '9': 440.00,
                'a': 466.16,
                'b': 493.88,
                'c': 523.25,
                'd': 554.37,
                'e': 587.33,
                'f': 0
            };

            const sampleRate = audioContext.sampleRate;
            const length = Math.ceil(sampleRate * duration);
            const buffer = audioContext.createBuffer(1, length, sampleRate);
            const data = buffer.getChannelData(0);

            for (let i = 0; i < length; i++) {
                const t = i / sampleRate;
                data[i] = frequencies[note] * Math.sin(2 * Math.PI * frequencies[note] * t);
            }

            return buffer;
        }

        function playNote(note, duration) {
            buffer = loadNoteBuffer(note, duration);
            source = audioContext.createBufferSource();
            source.buffer = buffer;
            source.connect(audioContext.destination);
            source.start();
        }

        function playMusic(index, music) {
            if (isPlaying && index < music.length) {
                let note = music[index];
                let duration = 0.125 * (100 / tempo);

                // Check for consecutive identical notes and extend duration
                while (index + 1 < music.length && music[index + 1] === note) {
                    duration += 0.125 * (100 / tempo);
                    index++;
                }

                playNote(note, duration);
                setTimeout(() => playMusic(index + 1, music), duration * 1000);
            } else if (isPlaying) {
                // Continue playing in a loop
                setTimeout(() => playMusic(0, music), 125 * (100 / tempo));
            }
        }

        function startMusic() {
            const musicInput = document.getElementById('musicInput').value;
            if (!isPlaying && musicInput) {
                isPlaying = true;
                playMusic(0, musicInput);
            }
        }

        function stopMusic() {
            isPlaying = false;
            if (source) {
                source.stop(0);
                source.disconnect();
            }
        }

        const tempoSlider = document.getElementById('tempoSlider');
        const currentTempo = document.getElementById('currentTempo');

        tempoSlider.addEventListener('input', function () {
            tempo = parseInt(tempoSlider.value, 10);
            currentTempo.textContent = tempo + " BPM";
        });

        async function convertImageToText() {
            const imageInput = document.getElementById('imageInput');
            const file = imageInput.files[0];

            const { TesseractWorker } = Tesseract;
            const worker = new TesseractWorker();

            worker
                .recognize(file)
                .progress((message) => {
                    console.log('Progress:', message);
                })
                .then(({ text }) => {
                    const cleanedText = text.replace(/[^0-9a-f]/g, ''); // remove non-music characters
                    document.getElementById('musicInput').value = cleanedText;
                })
                .finally(() => {
                    worker.terminate();
                });
        }
    </script>
</body>

</html>